<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="quindar.space">
    <title>Quindar Proxy</title>

    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/css/quindar-proxy.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
	<div class="container" style="background-color:#efefef; margin-bottom: 40px;">
		<center><h2>Data Sources</h2></center>
    	<form action="/upload" method="post" enctype="multipart/form-data">
    		<table class="table table-hover" id="table1">
    			<thead>
		            <tr>
		                <th>Source Name</th>
		                <th>IP Address</th>
		                <th>File</th>
		                <th>Upload</th>
		            </tr>
		        </thead>
		        <tbody class="details" id="body1">
		              <tr>
		                   <td><input type="text" name="sourcename" class="form-control sourcename" required></td>
		                   <td><input type="text" name="sourceip" class="form-control sourceip" required></td>
		                   <td>
								<div class="input-group">
	                				<label class="input-group-btn">
		                    			<span class="btn btn-primary">
		                        			Browse <input type="file" name="file" id="file" style="display: none;">
		                    			</span>
	               					</label>
	                				<input type="text" class="form-control" id="filename" readonly>
	            				</div>
	    				   </td>
		                   <td><input type="submit"  class="btn btn-primary upload" value="Upload"></td>
		              </tr>
		        </tbody>
	    	</table>
	  	</form>
		<center><p><%= typeof err_desc!='undefined' ? err_desc : "" %></p></center>
	</div>

	<div class="container" style="background-color:#efefef">
		<% if(configlist.length > 0) { %>
		<table class="table table-hover" id="table2">
    		<thead>
		        <tr>
		            <th>Source Name</th>
	                <th>IP Address</th>
	                <th>File Name</th>
	            </tr>
	        </thead>
	        <tbody class="details" id="body2">
		     	<% for (var i=0;i<configlist.length;i++) { %>
		     	<tr>
		     	    <td><%= configlist[i].source.name %></td>
		            <td><%= configlist[i].source.ipaddress %></td>
	                <td><%= configlist[i].source.filename %></td>
		        </tr>
      	    	<% } %>
		    </tbody>
	    </table>
		<% } %>
	</div>

	<!-- jQuery -->
    <script src="/scripts/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="/scripts/bootstrap.min.js"></script>
    <script>
		$("#file").change(function(){
			var filename = $(this).val().replace(/\\/g, '/').replace(/.*\//, '');
			$('#filename').val(filename);
		});
		$('.upload').click(function(){
			var ipformat = /^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
			if($('.sourceip').val() != "" && (! $('.sourceip').val().match(ipformat))) {
				alert("You have entered an invalid IP address");
				return false;
			}
		});
	</script>

</body>
</html>
